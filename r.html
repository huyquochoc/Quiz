<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Redirect...</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial;
  background: #f6f7fb;
  text-align: center;
  padding-top: 60px;
}
.box {
  background: white;
  padding: 25px;
  max-width: 520px;
  margin: auto;
  border-radius: 12px;
  box-shadow: 0 10px 20px rgba(0,0,0,.08);
}
</style>
</head>

<body>
<div class="box">
  <h2 id="status">üîÑ ƒêang x·ª≠ l√Ω...</h2>
  <p id="msg"></p>
</div>

<script>
const JSON_URL = "https://huyquochoc.github.io/Quiz/shortlinks.json";

const params = new URLSearchParams(window.location.search);
const key = params.get("id");

const statusEl = document.getElementById("status");
const msgEl = document.getElementById("msg");

console.log("Requested key:", key);

if (!key) {
  statusEl.textContent = "‚ùå Thi·∫øu ?id=";
  throw new Error("Missing id");
}

fetch(JSON_URL + "?t=" + Date.now()) // tr√°nh cache
  .then(r => r.json())
  .then(data => {
    console.log("Loaded JSON:", data);

    if (!data[key]) {
      statusEl.textContent = "‚ùå Key kh√¥ng t·ªìn t·∫°i";
      msgEl.textContent = "Kh√¥ng t√¨m th·∫•y: " + key;
      return;
    }

    const record = data[key];
    console.log("Record:", record);

    const url = record.url;

    if (!url) {
      statusEl.textContent = "‚ùå Kh√¥ng c√≥ URL";
      return;
    }

    statusEl.textContent = "‚úÖ ƒêang chuy·ªÉn h∆∞·ªõng...";
    msgEl.textContent = url;

    console.log("Redirecting to:", url);

    // REDIRECT
    setTimeout(() => {
      window.location.replace(url);
    }, 600);
  })
  .catch(err => {
    console.error("Fetch error:", err);
    statusEl.textContent = "‚ö†Ô∏è L·ªói t·∫£i JSON";
    msgEl.textContent = err.toString();
  });
</script>
</body>
</html>
